#!/usr/bin/env node
// # -*- js   -*-
// #
// #!/usr/bin/env bash
// # -*- bash -*-
// #


var _       = require("underscore");
var cheerio = require("cheerio");
var Topogo = require("topogo").Topogo;
var River  = require("da_river").River;

var Feed   = require("../Server/RSS_Reader/Feed").Feed;
var Post   = require("../Server/RSS_Reader/Post").Post;


var items = [];

River.new()

.job(function (j) {
  Feed.update_next(j);
})

.job('save posts', function (j, list) {
  items = items.concat(list);
  j.finish(list);
})

.run(function (fin, row) {
  console.log(items[0].data);
  Topogo.close();
});


process.on('SIGINT', function () {
  Topogo.close();
});
