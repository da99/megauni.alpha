


[

  {
    "const"      : [
      "@MIN_FAILS", "Log_In.FAIL_COUNT"
    ],

    "before all" : [
      "create user",
      "create screen_name",
      "create screen_name"
    ],

    "after each" : "Log_In.reset_all"
  },

  { "desc" : "Log_In.create" },

  {
    "it"    : "returns the id of the user",
    "input" : {
      "screen_name" : "sn_1.screen_name",
      "pass"        : "valid_pass",
      "ip"          : "127.0.0.1"
    },
    "output": {"id" : "user.id"}
  },

  {
    "it"     : "returns user id: fails = @MIN_FAILS, success = 1",
    "input"  : [
      "@MIN_FAILS", "times", [ "bad_log_in" ],
      "good_log_in"
    ],
    "output" : {"id": "user.id"}
  },

  {
    "it"     : "returns user id: fails = @MIN_FAILS, success = 1, fails = 1, success = 1",
    "input"  : [
      "@MIN_FAILS", "times", [ "bad_log_in" ],
      "good_log_in", "bad_log_in", "good_log_in"
    ],
    "output" : {"id": "user.id"}
  },

  {
    "it"     : "returns lock-out error: @MIN_FAILS + 1",
    "input"  : [
      "@MIN_FAILS + 1", "times", [ "bad_log_in" ],
      "good_log_in"
    ],
    "output" : {"error": "screen_name: locked out"}
  },

  {
    "it"     : "returns user id: fails = @MIN_FAILS + 1, 1 success of another screen name",
    "input"  : [
      "@MIN_FAILS + 1", "times", [ "bad_log_in" ],
      "good_log_in"
    ],
    "output" : {"id": "user.id"}
  },

  {
    "it"     : "returns user id: fails = @MIN_FAILS + 1 that are 25 hours old, 1 success",
    "input"  : [
      "@MIN_FAILS + 1", "times", [ "bad_log_in" ],
      "age_ify log_in_attempts", [25],
      "good_log_in"
    ],
    "output" : {"id": "user.id"}
  }


]
