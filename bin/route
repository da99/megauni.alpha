#!/usr/bin/env bash
# -*- bash -*-
#
# Examples:
#    bin/route Chat
#
cmd="$1"
model="$2"
file_name="$3"
set -u -e -o pipefail

function compile_template {
  tmpl="Server/App/routes.template.js"
  class_name="$model"

  mkdir -p Server/$model
  if [[ -z "$file_name" ]]
  then
    new_file="Server/$model/routes.js"
  else
    new_file="Server/$model/routes.$file_name.js"
    class_name="$file_name"
  fi

  if [[ -f "$new_file" ]]
  then
    echo "skipping creationg of file:"
  else
    sed "s/MODEL/$class_name/g" "$tmpl" >> "$new_file"
  fi

  echo "$new_file"
}

case "$cmd" in

  create)
    compile_template
    ;;

  *)
    echo "Unknown command: $@"
    exit 1
    ;;

esac


