#!/usr/bin/env bash
# -*- bash -*-
#
#
set -u -e -o pipefail

source bin/env
pid="$(pgrep -f 'unicorn master' || echo '')"


case "$@" in

  start)
    if [[ -n "$pid" ]]
    then
      echo "Stopping..."
      bin/server stop
      sleep 1
    fi
    bundle exec foreman start
    ;;

  stop)
    if [[ -n "$pid" ]]
    then
      kill "$pid"
    else
      echo "No pid found."
    fi
    ;;

  *)
    echo "Unrecognized command: $@" 1>&2
    exit 1
    ;;

esac



