#!/usr/bin/env bash
# -*- bash -*-
#
cmd="$1"
set -u -e -o pipefail

mods=( Customer Screen_Name Home_Page );
mods=( Customer Screen_Name Home_Page Chat Comment Follow Contact IM Label Post )

bin="../../node_modules/duck_duck_duck/bin/duck_duck_duck"

if [[ "$cmd" == "" ]]
then
  cmd="up"
fi

if [[ "$cmd" == "create" ]]
then

  if [[ ! "${mods[@]}" == *"$2"* ]]
  then
    echo "$2 not in list."
    exit 1
  fi

  cd "Server/$2"
  $bin create $3
  cd ../..

else

  if [[ "$cmd" == "down" ]]
  then
    if [ ! -n "${IS_DEV+x}" ]
    then
      echo "This is not a dev machine."
      exit 1
    fi
  fi

  for m in "${mods[@]}"
  do
    cd "Server/$m"
    echo "$m"
    $bin $@
    cd ../..
  done

fi

