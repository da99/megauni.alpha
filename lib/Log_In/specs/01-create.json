


[

  "const", [ "@FAIL_LIMIT", 5 ],

  "before all", [
    "create user",
    "create screen_name",
    "create screen_name"
  ],

  "after each", "Log_In.reset_all",

  "desc", "Log_In.attempt",

  "it",   "returns the id of the user",
  "input", {
    "screen_name" : "sn_1.screen_name",
    "pass"        : "user.pass",
    "ip"          : "127.0.0.1"
  },
  "output", {"id" : "user.id"},

  "it"     , "returns user id: fails = @FAIL_LIMIT, success = 1",
  "input"  , [
    "@FAIL_LIMIT", "times", [ "bad_log_in" ],
    "good_log_in"
  ],
  "output" , {"id": "user.id"},

  "it"     , "returns user id: fails = @FAIL_LIMIT, success = 1, fails = 1, success = 1",
  "input"  , [
    "@FAIL_LIMIT", "times", [ "bad_log_in" ],
    "good_log_in", "bad_log_in", "good_log_in"
  ],
  "output" , {"id": "user.id"},

  "it"     , "returns lock-out error: @FAIL_LIMIT + 1",
  "input"  , [
    "@FAIL_LIMIT + 1", "times", [ "bad_log_in" ],
    "good_log_in"
  ],
  "output" , {"error": "screen_name: locked out"},

  "it"     , "returns user id: fails = @FAIL_LIMIT + 1, 1 success of another screen name",
  "input"  , [
    "@FAIL_LIMIT + 1", "times", [ "bad_log_in" ],
    "good_log_in"
  ],
  "output" , {"id": "user.id"},

  "it"     , "returns user id: fails = @FAIL_LIMIT + 1 that are 25 hours old, 1 success",
  "input"  , [
    "@FAIL_LIMIT + 1", "times", [ "bad_log_in" ],
    "age_ify log_in_attempts", [25],
    "good_log_in"
  ],
  "output" , {"id": "user.id"}

]
